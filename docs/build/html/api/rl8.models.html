

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>rl8.models package &mdash; rl8  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css" />

  
      <script src="../_static/jquery.js"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
      <script src="../_static/doctools.js"></script>
      <script src="../_static/sphinx_highlight.js"></script>
      <script src="../_static/clipboard.min.js"></script>
      <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="rl8.nn package" href="rl8.nn.html" />
    <link rel="prev" title="rl8.algorithms package" href="rl8.algorithms.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            rl8
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../cli.html">CLI</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="rl8.html">rl8 package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="rl8.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="rl8.algorithms.html">rl8.algorithms package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">rl8.models package</a></li>
<li class="toctree-l4"><a class="reference internal" href="rl8.nn.html">rl8.nn package</a></li>
<li class="toctree-l4"><a class="reference internal" href="rl8.policies.html">rl8.policies package</a></li>
<li class="toctree-l4"><a class="reference internal" href="rl8.trainers.html">rl8.trainers package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rl8.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="rl8.html#module-rl8.conditions">rl8.conditions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="rl8.html#module-rl8.distributions">rl8.distributions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="rl8.html#module-rl8.env">rl8.env module</a></li>
<li class="toctree-l3"><a class="reference internal" href="rl8.html#module-rl8.schedulers">rl8.schedulers module</a></li>
<li class="toctree-l3"><a class="reference internal" href="rl8.html#module-rl8.views">rl8.views module</a></li>
<li class="toctree-l3"><a class="reference internal" href="rl8.html#module-rl8">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">rl8</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">rl8</a></li>
          <li class="breadcrumb-item"><a href="rl8.html">rl8 package</a></li>
      <li class="breadcrumb-item active">rl8.models package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/rl8.models.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="rl8-models-package">
<h1>rl8.models package<a class="headerlink" href="#rl8-models-package" title="Permalink to this heading"></a></h1>
<section id="module-rl8.models">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-rl8.models" title="Permalink to this heading"></a></h2>
<p>Definitions related to parameterizations of policies.</p>
<p>Models are intended to be called with their respective forward pass (like any
other PyTorch module) to get the inputs to the policy’s action
distribution (along with other data depending on the type of model being used).
Models are expected to store their value function approximations after each
forward pass in some intermediate attribute so it can be accessed with a
subsequent call to a <code class="docutils literal notranslate"><span class="pre">value_function</span></code> method.</p>
<p>Models are largely inspired by RLlib’s <a class="reference external" href="https://github.com/ray-project/ray/blob/master/rllib/models/modelv2.py">model concept</a>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="rl8.models.DefaultContinuousModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rl8.models.</span></span><span class="sig-name descname"><span class="pre">DefaultContinuousModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Unbounded</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Unbounded</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hiddens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(256,</span> <span class="pre">256)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rl8/models/_feedforward.html#DefaultContinuousModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.DefaultContinuousModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#rl8.models.GenericModel" title="rl8.models._feedforward.GenericModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericModel</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Unbounded</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Unbounded</span></code>]</p>
<p>Default model for 1D continuous observations and action spaces.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.DefaultContinuousModel.latent_model">
<span class="sig-name descname"><span class="pre">latent_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Sequential.html#torch.nn.Sequential" title="(in PyTorch v2.9)"><span class="pre">Sequential</span></a></em><a class="headerlink" href="#rl8.models.DefaultContinuousModel.latent_model" title="Permalink to this definition"></a></dt>
<dd><p>Transform observations to inputs for output heads.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.DefaultContinuousModel.action_mean">
<span class="sig-name descname"><span class="pre">action_mean</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Linear.html#torch.nn.Linear" title="(in PyTorch v2.9)"><span class="pre">Linear</span></a></em><a class="headerlink" href="#rl8.models.DefaultContinuousModel.action_mean" title="Permalink to this definition"></a></dt>
<dd><p>Output head for action mean for a normal distribution.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.DefaultContinuousModel.action_log_std">
<span class="sig-name descname"><span class="pre">action_log_std</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Linear.html#torch.nn.Linear" title="(in PyTorch v2.9)"><span class="pre">Linear</span></a></em><a class="headerlink" href="#rl8.models.DefaultContinuousModel.action_log_std" title="Permalink to this definition"></a></dt>
<dd><p>Output head for action log std for a normal distribution.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.DefaultContinuousModel.vf_model">
<span class="sig-name descname"><span class="pre">vf_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Sequential.html#torch.nn.Sequential" title="(in PyTorch v2.9)"><span class="pre">Sequential</span></a></em><a class="headerlink" href="#rl8.models.DefaultContinuousModel.vf_model" title="Permalink to this definition"></a></dt>
<dd><p>Value function model, independent of action params.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.DefaultContinuousModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorDict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TensorDict</span></span></span><a class="reference internal" href="../_modules/rl8/models/_feedforward.html#DefaultContinuousModel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.DefaultContinuousModel.forward" title="Permalink to this definition"></a></dt>
<dd><p>Process a batch of tensors and return features to be fed into an
action distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> – A tensordict expected to have at least an <code class="docutils literal notranslate"><span class="pre">&quot;obs&quot;</span></code> key with any
tensor spec. The policy that the model is a component of
processes the batch according to <a class="reference internal" href="#rl8.models.Model.view_requirements" title="rl8.models.Model.view_requirements"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.view_requirements</span></code></a>
prior to passing the batch to the forward pass. The tensordict
must have a 1D batch shape like <code class="docutils literal notranslate"><span class="pre">[B,</span> <span class="pre">...]</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Features that will be passed to an action distribution with batch
shape like <code class="docutils literal notranslate"><span class="pre">[B,</span> <span class="pre">...]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.DefaultContinuousModel.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><span class="pre">device</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/rl8/models/_feedforward.html#DefaultContinuousModel.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.DefaultContinuousModel.to" title="Permalink to this definition"></a></dt>
<dd><p>Helper for changing the device the model is on.</p>
<p>The specs associated with the model aren’t updated with the PyTorch
module’s <code class="docutils literal notranslate"><span class="pre">to</span></code> method since they aren’t PyTorch modules themselves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> – Target device.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.DefaultContinuousModel.value_function">
<span class="sig-name descname"><span class="pre">value_function</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/rl8/models/_feedforward.html#DefaultContinuousModel.value_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.DefaultContinuousModel.value_function" title="Permalink to this definition"></a></dt>
<dd><p>Return the value function output for the most recent forward pass.
Note that a :meth`GenericModelBase.forward` call has to be performed
first before this method can return anything.</p>
<p>This helps prevent extra forward passes from being performed just to
get a value function output in case the value function and action
distribution components share parameters.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rl8.models.DefaultDiscreteModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rl8.models.</span></span><span class="sig-name descname"><span class="pre">DefaultDiscreteModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Unbounded</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Categorical</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hiddens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(256,</span> <span class="pre">256)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rl8/models/_feedforward.html#DefaultDiscreteModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.DefaultDiscreteModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#rl8.models.GenericModel" title="rl8.models._feedforward.GenericModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericModel</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Unbounded</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Categorical</span></code>]</p>
<p>Default model for 1D continuous observations and discrete action spaces.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.DefaultDiscreteModel.feature_model">
<span class="sig-name descname"><span class="pre">feature_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Sequential.html#torch.nn.Sequential" title="(in PyTorch v2.9)"><span class="pre">Sequential</span></a></em><a class="headerlink" href="#rl8.models.DefaultDiscreteModel.feature_model" title="Permalink to this definition"></a></dt>
<dd><p>Transform observations to features for action distributions.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.DefaultDiscreteModel.vf_model">
<span class="sig-name descname"><span class="pre">vf_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Sequential.html#torch.nn.Sequential" title="(in PyTorch v2.9)"><span class="pre">Sequential</span></a></em><a class="headerlink" href="#rl8.models.DefaultDiscreteModel.vf_model" title="Permalink to this definition"></a></dt>
<dd><p>Value function model, independent of action params.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.DefaultDiscreteModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorDict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TensorDict</span></span></span><a class="reference internal" href="../_modules/rl8/models/_feedforward.html#DefaultDiscreteModel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.DefaultDiscreteModel.forward" title="Permalink to this definition"></a></dt>
<dd><p>Process a batch of tensors and return features to be fed into an
action distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> – A tensordict expected to have at least an <code class="docutils literal notranslate"><span class="pre">&quot;obs&quot;</span></code> key with any
tensor spec. The policy that the model is a component of
processes the batch according to <a class="reference internal" href="#rl8.models.Model.view_requirements" title="rl8.models.Model.view_requirements"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.view_requirements</span></code></a>
prior to passing the batch to the forward pass. The tensordict
must have a 1D batch shape like <code class="docutils literal notranslate"><span class="pre">[B,</span> <span class="pre">...]</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Features that will be passed to an action distribution with batch
shape like <code class="docutils literal notranslate"><span class="pre">[B,</span> <span class="pre">...]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.DefaultDiscreteModel.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><span class="pre">device</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/rl8/models/_feedforward.html#DefaultDiscreteModel.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.DefaultDiscreteModel.to" title="Permalink to this definition"></a></dt>
<dd><p>Helper for changing the device the model is on.</p>
<p>The specs associated with the model aren’t updated with the PyTorch
module’s <code class="docutils literal notranslate"><span class="pre">to</span></code> method since they aren’t PyTorch modules themselves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> – Target device.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.DefaultDiscreteModel.value_function">
<span class="sig-name descname"><span class="pre">value_function</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/rl8/models/_feedforward.html#DefaultDiscreteModel.value_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.DefaultDiscreteModel.value_function" title="Permalink to this definition"></a></dt>
<dd><p>Return the value function output for the most recent forward pass.
Note that a :meth`GenericModelBase.forward` call has to be performed
first before this method can return anything.</p>
<p>This helps prevent extra forward passes from being performed just to
get a value function output in case the value function and action
distribution components share parameters.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rl8.models.GenericModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rl8.models.</span></span><span class="sig-name descname"><span class="pre">GenericModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ObservationSpec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ActionSpec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.Any" title="(in Python v3.10)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rl8/models/_feedforward.html#GenericModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.GenericModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#rl8.models.Model" title="rl8.models._feedforward.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>, <a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.Generic" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">_ObservationSpec</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">_ActionSpec</span></code>]</p>
<p>Generic model for constructing models from fixed observation and action specs.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.GenericModel.action_spec">
<span class="sig-name descname"><span class="pre">action_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">_ActionSpec</span></em><a class="headerlink" href="#rl8.models.GenericModel.action_spec" title="Permalink to this definition"></a></dt>
<dd><p>Action space campatible with the model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.GenericModel.observation_spec">
<span class="sig-name descname"><span class="pre">observation_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">_ObservationSpec</span></em><a class="headerlink" href="#rl8.models.GenericModel.observation_spec" title="Permalink to this definition"></a></dt>
<dd><p>Observation space compatible with the model.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rl8.models.GenericModelBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rl8.models.</span></span><span class="sig-name descname"><span class="pre">GenericModelBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorSpec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorSpec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.Any" title="(in Python v3.10)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rl8/models/_base.html#GenericModelBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.GenericModelBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="rl8.nn.modules.html#rl8.nn.modules.module.Module" title="rl8.nn.modules.module.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">_P</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">_T</span></code>]</p>
<p>The base for the policy component that processes environment
observations into a value function approximation and features
to be consumed by an action distribution for action sampling.</p>
<p>All model flavors (i.e., feedforward or recurrent) inherit from this
base. This just provides a common interface for different model flavors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observation_spec</strong> – Spec defining the forward pass input.</p></li>
<li><p><strong>action_spec</strong> – Spec defining the outputs of the policy’s action
distribution that this model is a component of.</p></li>
<li><p><strong>config</strong> – Model-specific configuration.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.GenericModelBase.observation_spec">
<span class="sig-name descname"><span class="pre">observation_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">TensorSpec</span></em><a class="headerlink" href="#rl8.models.GenericModelBase.observation_spec" title="Permalink to this definition"></a></dt>
<dd><p>Spec defining the forward pass input. Useful for validating the forward
pass and for defining the model as a function of the observation spec.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.GenericModelBase.action_spec">
<span class="sig-name descname"><span class="pre">action_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">TensorSpec</span></em><a class="headerlink" href="#rl8.models.GenericModelBase.action_spec" title="Permalink to this definition"></a></dt>
<dd><p>Spec defining the outputs of the policy’s action distribution that
this model is a component of. Useful for defining the model as a
function of the action spec.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.GenericModelBase.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#dict" title="(in Python v3.10)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.Any" title="(in Python v3.10)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#rl8.models.GenericModelBase.config" title="Permalink to this definition"></a></dt>
<dd><p>Model-specific configuration. Passed from the policy and algorithm.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="rl8.models.GenericModelBase.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><span class="pre">device</span></a></em><a class="headerlink" href="#rl8.models.GenericModelBase.device" title="Permalink to this definition"></a></dt>
<dd><p>Return the device the model is currently on.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.GenericModelBase.to">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><span class="pre">device</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/rl8/models/_base.html#GenericModelBase.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.GenericModelBase.to" title="Permalink to this definition"></a></dt>
<dd><p>Helper for changing the device the model is on.</p>
<p>The specs associated with the model aren’t updated with the PyTorch
module’s <code class="docutils literal notranslate"><span class="pre">to</span></code> method since they aren’t PyTorch modules themselves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> – Target device.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.GenericModelBase.value_function">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value_function</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/rl8/models/_base.html#GenericModelBase.value_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.GenericModelBase.value_function" title="Permalink to this definition"></a></dt>
<dd><p>Return the value function output for the most recent forward pass.
Note that a :meth`GenericModelBase.forward` call has to be performed
first before this method can return anything.</p>
<p>This helps prevent extra forward passes from being performed just to
get a value function output in case the value function and action
distribution components share parameters.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rl8.models.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rl8.models.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorSpec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorSpec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.Any" title="(in Python v3.10)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rl8/models/_feedforward.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.Model" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#rl8.models.GenericModelBase" title="rl8.models._base.GenericModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericModelBase</span></code></a>[(&lt;class ‘tensordict._td.TensorDict’&gt;,), <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorDict</span></code>]</p>
<p>Feedforward policy component that processes environment observations into
a value function approximation and features to be consumed by an
action distribution for action sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observation_spec</strong> – Spec defining the forward pass input.</p></li>
<li><p><strong>action_spec</strong> – Spec defining the outputs of the policy’s action
distribution that this model is a component of.</p></li>
<li><p><strong>config</strong> – Model-specific configuration.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.Model.view_requirements">
<span class="sig-name descname"><span class="pre">view_requirements</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#dict" title="(in Python v3.10)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="rl8.html#rl8.views.ViewRequirement" title="rl8.views.ViewRequirement"><span class="pre">rl8.views.ViewRequirement</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#rl8.models.Model.view_requirements" title="Permalink to this definition"></a></dt>
<dd><p>Requirements on how a tensor batch should be preprocessed by the
policy prior to being passed to the forward pass. Useful for handling
sequence shifting or masking so you don’t have to.
By default, observations are passed with no shifting.
This should be overwritten in a model’s <code class="docutils literal notranslate"><span class="pre">__init__</span></code> for custom view
requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.Model.apply_view_requirements">
<span class="sig-name descname"><span class="pre">apply_view_requirements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorDict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.Literal" title="(in Python v3.10)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'last'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'all'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'last'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TensorDict</span></span></span><a class="reference internal" href="../_modules/rl8/models/_feedforward.html#Model.apply_view_requirements"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.Model.apply_view_requirements" title="Permalink to this definition"></a></dt>
<dd><p>Apply the model’s view requirements, reshaping tensors as-needed.</p>
<p>This is usually called by the policy that the model is a component
of, but can be used within the model if the model is deployed without
the policy or action distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – Batch to feed into the policy’s underlying model. Expected
to be of size <code class="docutils literal notranslate"><span class="pre">[B,</span> <span class="pre">T,</span> <span class="pre">...]</span></code> where <code class="docutils literal notranslate"><span class="pre">B</span></code> is the batch dimension,
and <code class="docutils literal notranslate"><span class="pre">T</span></code> is the time or sequence dimension. <code class="docutils literal notranslate"><span class="pre">B</span></code> is typically
the number of parallel environments being sampled for during
massively parallel training, and <code class="docutils literal notranslate"><span class="pre">T</span></code> is typically the number
of time steps or observations sampled from the environments.
The <code class="docutils literal notranslate"><span class="pre">B</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code> dimensions are typically combined into one dimension
during application of the view requirements.</p></li>
<li><p><strong>kind</strong> – <p>String indicating the type of view requirements to apply.
The model’s view requirements are applied slightly differently
depending on the value. Options include:</p>
<blockquote>
<div><ul>
<li><p>”last”: Apply the view requirements using only the samples
necessary to sample for the most recent observations
within the <code class="docutils literal notranslate"><span class="pre">batch</span></code>’s <code class="docutils literal notranslate"><span class="pre">T</span></code> dimension.</p></li>
<li><p>”all”: Sample from <code class="docutils literal notranslate"><span class="pre">batch</span></code> using all observations within
the <code class="docutils literal notranslate"><span class="pre">batch</span></code>’s <code class="docutils literal notranslate"><span class="pre">T</span></code> dimension. Expand the <code class="docutils literal notranslate"><span class="pre">B</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code>
dimensions together.</p></li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.Model.default_model_cls">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_model_cls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorSpec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorSpec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#type" title="(in Python v3.10)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'Model'</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/rl8/models/_feedforward.html#Model.default_model_cls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.Model.default_model_cls" title="Permalink to this definition"></a></dt>
<dd><p>Return a default model class based on the given observation and
action specs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observation_spec</strong> – Environment observation spec.</p></li>
<li><p><strong>action_spec</strong> – Environment action spec.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A default model class.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="rl8.models.Model.drop_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">drop_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></em><a class="headerlink" href="#rl8.models.Model.drop_size" title="Permalink to this definition"></a></dt>
<dd><p>Return the model’s drop size (also the drop size for all view
requirements).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.Model.forward">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorDict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TensorDict</span></span></span><a class="reference internal" href="../_modules/rl8/models/_feedforward.html#Model.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.Model.forward" title="Permalink to this definition"></a></dt>
<dd><p>Process a batch of tensors and return features to be fed into an
action distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> – A tensordict expected to have at least an <code class="docutils literal notranslate"><span class="pre">&quot;obs&quot;</span></code> key with any
tensor spec. The policy that the model is a component of
processes the batch according to <a class="reference internal" href="#rl8.models.Model.view_requirements" title="rl8.models.Model.view_requirements"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.view_requirements</span></code></a>
prior to passing the batch to the forward pass. The tensordict
must have a 1D batch shape like <code class="docutils literal notranslate"><span class="pre">[B,</span> <span class="pre">...]</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Features that will be passed to an action distribution with batch
shape like <code class="docutils literal notranslate"><span class="pre">[B,</span> <span class="pre">...]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.Model.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><span class="pre">device</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/rl8/models/_feedforward.html#Model.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.Model.to" title="Permalink to this definition"></a></dt>
<dd><p>Helper for changing the device the model is on.</p>
<p>The specs associated with the model aren’t updated with the PyTorch
module’s <code class="docutils literal notranslate"><span class="pre">to</span></code> method since they aren’t PyTorch modules themselves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> – Target device.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.Model.validate_view_requirements">
<span class="sig-name descname"><span class="pre">validate_view_requirements</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.10/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/rl8/models/_feedforward.html#Model.validate_view_requirements"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.Model.validate_view_requirements" title="Permalink to this definition"></a></dt>
<dd><p>Helper for validating a model’s view requirements.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.10/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – If the model’s view requirements result in an
    ambiguous batch size, making training and sampling impossible.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rl8.models.ModelFactory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rl8.models.</span></span><span class="sig-name descname"><span class="pre">ModelFactory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rl8/models/_feedforward.html#ModelFactory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.ModelFactory" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.Protocol" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></a></p>
<p>Factory protocol describing how to create a model instance.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rl8.models.DefaultContinuousRecurrentModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rl8.models.</span></span><span class="sig-name descname"><span class="pre">DefaultContinuousRecurrentModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Unbounded</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Unbounded</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rl8/models/_recurrent.html#DefaultContinuousRecurrentModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.DefaultContinuousRecurrentModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#rl8.models.GenericRecurrentModel" title="rl8.models._recurrent.GenericRecurrentModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericRecurrentModel</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Unbounded</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Unbounded</span></code>]</p>
<p>Default recurrent model for 1D continuous observations and action spaces.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.DefaultContinuousRecurrentModel.lstm">
<span class="sig-name descname"><span class="pre">lstm</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.modules.rnn.LSTM.html#torch.nn.modules.rnn.LSTM" title="(in PyTorch v2.9)"><span class="pre">LSTM</span></a></em><a class="headerlink" href="#rl8.models.DefaultContinuousRecurrentModel.lstm" title="Permalink to this definition"></a></dt>
<dd><p>Transform observations to inputs for output heads.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.DefaultContinuousRecurrentModel.action_mean">
<span class="sig-name descname"><span class="pre">action_mean</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Linear.html#torch.nn.Linear" title="(in PyTorch v2.9)"><span class="pre">Linear</span></a></em><a class="headerlink" href="#rl8.models.DefaultContinuousRecurrentModel.action_mean" title="Permalink to this definition"></a></dt>
<dd><p>Output head for action mean for a normal distribution.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.DefaultContinuousRecurrentModel.action_log_std">
<span class="sig-name descname"><span class="pre">action_log_std</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Linear.html#torch.nn.Linear" title="(in PyTorch v2.9)"><span class="pre">Linear</span></a></em><a class="headerlink" href="#rl8.models.DefaultContinuousRecurrentModel.action_log_std" title="Permalink to this definition"></a></dt>
<dd><p>Output head for action log std for a normal distribution.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.DefaultContinuousRecurrentModel.vf_model">
<span class="sig-name descname"><span class="pre">vf_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Linear.html#torch.nn.Linear" title="(in PyTorch v2.9)"><span class="pre">Linear</span></a></em><a class="headerlink" href="#rl8.models.DefaultContinuousRecurrentModel.vf_model" title="Permalink to this definition"></a></dt>
<dd><p>Value function model, independent of action params.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.DefaultContinuousRecurrentModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorDict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">tensordict._td.TensorDict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tensordict._td.TensorDict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/rl8/models/_recurrent.html#DefaultContinuousRecurrentModel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.DefaultContinuousRecurrentModel.forward" title="Permalink to this definition"></a></dt>
<dd><p>Process a batch of tensors and return features to be fed into an
action distribution.</p>
<p>Both input arguments are expected to have a 2D batch shape like
<code class="docutils literal notranslate"><span class="pre">[B,</span> <span class="pre">T,</span> <span class="pre">...]</span></code> where <code class="docutils literal notranslate"><span class="pre">B</span></code> is the batch number (or typically the
number of parallel environments) and <code class="docutils literal notranslate"><span class="pre">T</span></code> is the sequence length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – A tensordict expected to have at least an <code class="docutils literal notranslate"><span class="pre">&quot;obs&quot;</span></code> key with any
tensor spec.</p></li>
<li><p><strong>states</strong> – A tensordict that contains the recurrent states for the
model and has spec equal to <a class="reference internal" href="#rl8.models.RecurrentModel.state_spec" title="rl8.models.RecurrentModel.state_spec"><code class="xref py py-attr docutils literal notranslate"><span class="pre">RecurrentModel.state_spec</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Features that will be passed to an action distribution and updated
recurrent states. The features are expected to have batch shape
like <code class="docutils literal notranslate"><span class="pre">[B</span> <span class="pre">*</span> <span class="pre">T,</span> <span class="pre">...]</span></code> while the updated recurrent states are
expected to have batch shape like <code class="docutils literal notranslate"><span class="pre">[B,</span> <span class="pre">...]</span></code>. In other words,
the batch and sequence dimension of the input arguments are
flattened together for the output features while the returned
recurrent states maintain the original batch dimension but don’t
have a sequence dimension.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.DefaultContinuousRecurrentModel.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><span class="pre">device</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/rl8/models/_recurrent.html#DefaultContinuousRecurrentModel.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.DefaultContinuousRecurrentModel.to" title="Permalink to this definition"></a></dt>
<dd><p>Helper for changing the device the model is on.</p>
<p>The specs associated with the model aren’t updated with the PyTorch
module’s <code class="docutils literal notranslate"><span class="pre">to</span></code> method since they aren’t PyTorch modules themselves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> – Target device.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.DefaultContinuousRecurrentModel.value_function">
<span class="sig-name descname"><span class="pre">value_function</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/rl8/models/_recurrent.html#DefaultContinuousRecurrentModel.value_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.DefaultContinuousRecurrentModel.value_function" title="Permalink to this definition"></a></dt>
<dd><p>Return the value function output for the most recent forward pass.
Note that a :meth`GenericModelBase.forward` call has to be performed
first before this method can return anything.</p>
<p>This helps prevent extra forward passes from being performed just to
get a value function output in case the value function and action
distribution components share parameters.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rl8.models.DefaultDiscreteRecurrentModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rl8.models.</span></span><span class="sig-name descname"><span class="pre">DefaultDiscreteRecurrentModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Unbounded</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Categorical</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rl8/models/_recurrent.html#DefaultDiscreteRecurrentModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.DefaultDiscreteRecurrentModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#rl8.models.GenericRecurrentModel" title="rl8.models._recurrent.GenericRecurrentModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericRecurrentModel</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Unbounded</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Categorical</span></code>]</p>
<p>Default recurrent model for 1D continuous observations and discrete action spaces.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.DefaultDiscreteRecurrentModel.lstm">
<span class="sig-name descname"><span class="pre">lstm</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.modules.rnn.LSTM.html#torch.nn.modules.rnn.LSTM" title="(in PyTorch v2.9)"><span class="pre">LSTM</span></a></em><a class="headerlink" href="#rl8.models.DefaultDiscreteRecurrentModel.lstm" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.DefaultDiscreteRecurrentModel.feature_head">
<span class="sig-name descname"><span class="pre">feature_head</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Linear.html#torch.nn.Linear" title="(in PyTorch v2.9)"><span class="pre">Linear</span></a></em><a class="headerlink" href="#rl8.models.DefaultDiscreteRecurrentModel.feature_head" title="Permalink to this definition"></a></dt>
<dd><p>Transform observations to features for action distributions.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.DefaultDiscreteRecurrentModel.vf_head">
<span class="sig-name descname"><span class="pre">vf_head</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Linear.html#torch.nn.Linear" title="(in PyTorch v2.9)"><span class="pre">Linear</span></a></em><a class="headerlink" href="#rl8.models.DefaultDiscreteRecurrentModel.vf_head" title="Permalink to this definition"></a></dt>
<dd><p>Value function model, independent of action params.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.DefaultDiscreteRecurrentModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorDict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">tensordict._td.TensorDict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tensordict._td.TensorDict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/rl8/models/_recurrent.html#DefaultDiscreteRecurrentModel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.DefaultDiscreteRecurrentModel.forward" title="Permalink to this definition"></a></dt>
<dd><p>Process a batch of tensors and return features to be fed into an
action distribution.</p>
<p>Both input arguments are expected to have a 2D batch shape like
<code class="docutils literal notranslate"><span class="pre">[B,</span> <span class="pre">T,</span> <span class="pre">...]</span></code> where <code class="docutils literal notranslate"><span class="pre">B</span></code> is the batch number (or typically the
number of parallel environments) and <code class="docutils literal notranslate"><span class="pre">T</span></code> is the sequence length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – A tensordict expected to have at least an <code class="docutils literal notranslate"><span class="pre">&quot;obs&quot;</span></code> key with any
tensor spec.</p></li>
<li><p><strong>states</strong> – A tensordict that contains the recurrent states for the
model and has spec equal to <a class="reference internal" href="#rl8.models.RecurrentModel.state_spec" title="rl8.models.RecurrentModel.state_spec"><code class="xref py py-attr docutils literal notranslate"><span class="pre">RecurrentModel.state_spec</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Features that will be passed to an action distribution and updated
recurrent states. The features are expected to have batch shape
like <code class="docutils literal notranslate"><span class="pre">[B</span> <span class="pre">*</span> <span class="pre">T,</span> <span class="pre">...]</span></code> while the updated recurrent states are
expected to have batch shape like <code class="docutils literal notranslate"><span class="pre">[B,</span> <span class="pre">...]</span></code>. In other words,
the batch and sequence dimension of the input arguments are
flattened together for the output features while the returned
recurrent states maintain the original batch dimension but don’t
have a sequence dimension.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.DefaultDiscreteRecurrentModel.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><span class="pre">device</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/rl8/models/_recurrent.html#DefaultDiscreteRecurrentModel.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.DefaultDiscreteRecurrentModel.to" title="Permalink to this definition"></a></dt>
<dd><p>Helper for changing the device the model is on.</p>
<p>The specs associated with the model aren’t updated with the PyTorch
module’s <code class="docutils literal notranslate"><span class="pre">to</span></code> method since they aren’t PyTorch modules themselves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> – Target device.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.DefaultDiscreteRecurrentModel.value_function">
<span class="sig-name descname"><span class="pre">value_function</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/rl8/models/_recurrent.html#DefaultDiscreteRecurrentModel.value_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.DefaultDiscreteRecurrentModel.value_function" title="Permalink to this definition"></a></dt>
<dd><p>Return the value function output for the most recent forward pass.
Note that a :meth`GenericModelBase.forward` call has to be performed
first before this method can return anything.</p>
<p>This helps prevent extra forward passes from being performed just to
get a value function output in case the value function and action
distribution components share parameters.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rl8.models.GenericRecurrentModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rl8.models.</span></span><span class="sig-name descname"><span class="pre">GenericRecurrentModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ObservationSpec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ActionSpec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.Any" title="(in Python v3.10)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rl8/models/_recurrent.html#GenericRecurrentModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.GenericRecurrentModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#rl8.models.RecurrentModel" title="rl8.models._recurrent.RecurrentModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">RecurrentModel</span></code></a>, <a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.Generic" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">_ObservationSpec</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">_ActionSpec</span></code>]</p>
<p>Generic model for constructing models from fixed observation and action specs.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.GenericRecurrentModel.action_spec">
<span class="sig-name descname"><span class="pre">action_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">_ActionSpec</span></em><a class="headerlink" href="#rl8.models.GenericRecurrentModel.action_spec" title="Permalink to this definition"></a></dt>
<dd><p>Action space campatible with the model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.GenericRecurrentModel.observation_spec">
<span class="sig-name descname"><span class="pre">observation_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">_ObservationSpec</span></em><a class="headerlink" href="#rl8.models.GenericRecurrentModel.observation_spec" title="Permalink to this definition"></a></dt>
<dd><p>Observation space compatible with the model.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rl8.models.RecurrentModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rl8.models.</span></span><span class="sig-name descname"><span class="pre">RecurrentModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorSpec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorSpec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.Any" title="(in Python v3.10)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rl8/models/_recurrent.html#RecurrentModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.RecurrentModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#rl8.models.GenericModelBase" title="rl8.models._base.GenericModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericModelBase</span></code></a>[(&lt;class ‘tensordict._td.TensorDict’&gt;, &lt;class ‘tensordict._td.TensorDict’&gt;), <a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#tuple" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TensorDict</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorDict</span></code>]]</p>
<p>Recurrent policy component that processes environment observations and
recurrent model states into a value function approximation, features
to be consumed by an action distribution for action sampling, and
updated recurrent model states to be used for subsequent calls.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observation_spec</strong> – Spec defining the forward pass input.</p></li>
<li><p><strong>action_spec</strong> – Spec defining the outputs of the policy’s action
distribution that this model is a component of.</p></li>
<li><p><strong>config</strong> – Model-specific configuration.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rl8.models.RecurrentModel.state_spec">
<span class="sig-name descname"><span class="pre">state_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Composite</span></em><a class="headerlink" href="#rl8.models.RecurrentModel.state_spec" title="Permalink to this definition"></a></dt>
<dd><p>Spec defining recurrent model states part of the forward pass input
and output. This is expected to be defined in a model’s <code class="docutils literal notranslate"><span class="pre">__init__</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.RecurrentModel.default_model_cls">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_model_cls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorSpec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorSpec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#type" title="(in Python v3.10)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'RecurrentModel'</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/rl8/models/_recurrent.html#RecurrentModel.default_model_cls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.RecurrentModel.default_model_cls" title="Permalink to this definition"></a></dt>
<dd><p>Return a default model class based on the given observation and
action specs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observation_spec</strong> – Environment observation spec.</p></li>
<li><p><strong>action_spec</strong> – Environment action spec.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A default model class.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.RecurrentModel.forward">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TensorDict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">tensordict._td.TensorDict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tensordict._td.TensorDict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/rl8/models/_recurrent.html#RecurrentModel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.RecurrentModel.forward" title="Permalink to this definition"></a></dt>
<dd><p>Process a batch of tensors and return features to be fed into an
action distribution.</p>
<p>Both input arguments are expected to have a 2D batch shape like
<code class="docutils literal notranslate"><span class="pre">[B,</span> <span class="pre">T,</span> <span class="pre">...]</span></code> where <code class="docutils literal notranslate"><span class="pre">B</span></code> is the batch number (or typically the
number of parallel environments) and <code class="docutils literal notranslate"><span class="pre">T</span></code> is the sequence length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – A tensordict expected to have at least an <code class="docutils literal notranslate"><span class="pre">&quot;obs&quot;</span></code> key with any
tensor spec.</p></li>
<li><p><strong>states</strong> – A tensordict that contains the recurrent states for the
model and has spec equal to <a class="reference internal" href="#rl8.models.RecurrentModel.state_spec" title="rl8.models.RecurrentModel.state_spec"><code class="xref py py-attr docutils literal notranslate"><span class="pre">RecurrentModel.state_spec</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Features that will be passed to an action distribution and updated
recurrent states. The features are expected to have batch shape
like <code class="docutils literal notranslate"><span class="pre">[B</span> <span class="pre">*</span> <span class="pre">T,</span> <span class="pre">...]</span></code> while the updated recurrent states are
expected to have batch shape like <code class="docutils literal notranslate"><span class="pre">[B,</span> <span class="pre">...]</span></code>. In other words,
the batch and sequence dimension of the input arguments are
flattened together for the output features while the returned
recurrent states maintain the original batch dimension but don’t
have a sequence dimension.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.RecurrentModel.init_states">
<span class="sig-name descname"><span class="pre">init_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TensorDict</span></span></span><a class="reference internal" href="../_modules/rl8/models/_recurrent.html#RecurrentModel.init_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.RecurrentModel.init_states" title="Permalink to this definition"></a></dt>
<dd><p>Return initial recurrent states for the model.</p>
<p>Override this to make your own method for initializing
recurrent states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> – Batch size to generate initial recurrent states for.
This is typically the number of environments being
stepped in parallel.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Recurrent model states that initialize a recurrent
sequence.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rl8.models.RecurrentModel.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><span class="pre">device</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/rl8/models/_recurrent.html#RecurrentModel.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.RecurrentModel.to" title="Permalink to this definition"></a></dt>
<dd><p>Helper for changing the device the model is on.</p>
<p>The specs associated with the model aren’t updated with the PyTorch
module’s <code class="docutils literal notranslate"><span class="pre">to</span></code> method since they aren’t PyTorch modules themselves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> – Target device.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated model.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rl8.models.RecurrentModelFactory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rl8.models.</span></span><span class="sig-name descname"><span class="pre">RecurrentModelFactory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rl8/models/_recurrent.html#RecurrentModelFactory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rl8.models.RecurrentModelFactory" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.Protocol" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></a></p>
<p>Factory protocol describing how to create a model instance.</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="rl8.algorithms.html" class="btn btn-neutral float-left" title="rl8.algorithms package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="rl8.nn.html" class="btn btn-neutral float-right" title="rl8.nn package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Andrew B.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>